import{a as F}from"./chunk-NUG3AV6E.js";import{a as j}from"./chunk-XW5VHITR.js";import{a as N}from"./chunk-BLXWA4ID.js";import"./chunk-M7VDHMM2.js";import"./chunk-QUJFQN2Y.js";import"./chunk-AAHKYY7C.js";import"./chunk-YOQU7OJT.js";import"./chunk-W5CSRS4J.js";import"./chunk-2Y3VSUBF.js";import"./chunk-7RJOF6FO.js";import"./chunk-XW2NLRB7.js";import"./chunk-PKG65ASR.js";import"./chunk-6KG2E3QT.js";import"./chunk-XROYUJS6.js";import"./chunk-ZC7RGWIF.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-JC3QQ35R.js";import"./chunk-CKP3SGE2.js";import"./chunk-DLKZZR2U.js";import{A as M,U as S,W as T,X as B,aa as D,e as x,g as P,m as R}from"./chunk-TEIXOV6V.js";import{Fa as C,Hb as w,Kb as I,O as h,Ra as p,Sa as f,T as a,Wa as g,Xa as s,Y as U,Ya as t,Z as v,ea as d,fb as E,ib as b,jb as l,o as m,sa as n,sb as u,ub as y}from"./chunk-5T4QEHQE.js";import"./chunk-6GMPNWKN.js";import"./chunk-GIEMQNDR.js";import"./chunk-WQS6UKMC.js";import"./chunk-HVWPZZJ7.js";import"./chunk-HSZY262W.js";import"./chunk-VSDHJBUA.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-NWJ5J3BN.js";var c=class r{baseURL(i){return N.apiURL+`usuarios/${i}`}httpClient=a(P);async editPersona(i,e){try{return await m(this.httpClient.put(this.baseURL(i),e))}catch(o){throw console.log("Mensaje de error",o.error.message),o.status===0?new Error(o.message):new Error("Formato de Email incorrecto")}}async getUsuarioById(i){try{return await m(this.httpClient.get(this.baseURL(i)))}catch(e){throw console.log("Mensaje de error",e.error?.message??e.message),e.status===0?new Error(e.message):new Error(e.error?.message??"Error al obtener usuario")}}static \u0275fac=function(e){return new(e||r)};static \u0275prov=h({token:r,factory:r.\u0275fac,providedIn:"root"})};function A(r,i){if(r&1){let e=E();s(0,"app-usuario-form",4),b("saved",function(_){U(e);let k=l();return v(k.handleEdit(_))}),t()}if(r&2){let e=l();g("user",e.userResource.value())("roles",e.roles())}}function q(r,i){r&1&&(s(0,"p"),u(1,"No hay usuario"),t())}function G(r,i){if(r&1&&(s(0,"div",3),u(1),t()),r&2){let e=l();n(),y(" ",e.errorMessage()," ")}}var L=class r{toastController=a(j);editService=a(c);id_usuario=I.required();router=a(R);userResource=w({params:()=>({id:this.id_usuario()}),loader:({params:i})=>this.editService.getUsuarioById(i.id)});roles=d([{id_rol:1,nombre:"administracion",descr:"Administraci\xF3n"},{id_rol:2,nombre:"perforador",descr:"T\xE9cnico de perforaci\xF3n"},{id_rol:3,nombre:"propietario",descr:"Propietario del sitio"}]);errorMessage=d("");disabled=d(!1);async handleEdit(i){try{this.disabled.set(!0);let e=await this.editService.editPersona(this.id_usuario(),i);console.log("Usuario editado",e),this.router.navigate(["/usuarios-list"])}catch(e){await(await this.toastController.create({message:e.message,duration:1e3,position:"bottom",color:"danger",animated:!0})).present()}this.disabled.set(!1)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=C({type:r,selectors:[["app-usuarios-edit"]],inputs:{id_usuario:[1,"id_usuario"]},decls:10,vars:3,consts:[[1,"ion-padding"],[3,"user","roles"],["fill","outline","expand","block",3,"click","disabled"],[1,"error-message"],[3,"saved","user","roles"]],template:function(e,o){e&1&&(s(0,"ion-content",0)(1,"ion-card")(2,"ion-card-content")(3,"h2"),u(4,"Editar usuario"),t(),p(5,A,1,2,"app-usuario-form",1)(6,q,2,0,"p"),s(7,"ion-button",2),b("click",function(){return o.userResource.reload()}),u(8," RECARGAR "),t(),p(9,G,2,1,"div",3),t()()()),e&2&&(n(5),f(o.userResource.hasValue()?5:6),n(2),g("disabled",o.disabled()),n(2),f(o.errorMessage()?9:-1))},dependencies:[S,T,B,M,D,x,F],encapsulation:2})};export{L as UsuariosEditPage};
