import{a as A}from"./chunk-6LSNIT6D.js";import{a as j}from"./chunk-QPFGTPJK.js";import{a as U}from"./chunk-BLXWA4ID.js";import"./chunk-3W6LJROD.js";import{R as T,U as M,V as k,W as B,X as S,aa as N,g as z,ka as $,m as R,ma as D,oa as F}from"./chunk-TEIXOV6V.js";import{Fa as C,Hb as P,Kb as I,O as h,Ra as _,Sa as b,T as a,Wa as f,Xa as l,Y as L,Ya as n,Z as E,Za as y,ea as v,fb as w,ib as u,jb as p,o as m,sa as c,sb as d,ub as x}from"./chunk-5T4QEHQE.js";import"./chunk-6GMPNWKN.js";import"./chunk-GIEMQNDR.js";import"./chunk-WQS6UKMC.js";import"./chunk-HVWPZZJ7.js";import"./chunk-HSZY262W.js";import"./chunk-VSDHJBUA.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-NWJ5J3BN.js";var g=class e{baseURL(t,o){return U.apiURL+`usuarios/${t}/pozos/${o}`}httpClient=a(z);auth=a(j);getUserIdOrThrow(){let t=this.auth.userId();if(!t)throw new Error("No se encontr\xF3 id_usuario autenticado");return t}async editIntervaloLito(t,o,i){let r=this.getUserIdOrThrow();try{return await m(this.httpClient.put(`${this.baseURL(r,t)}/intervalo_litologico/${o}`,i))}catch(s){throw console.log("Mensaje de error",s.error.message),s.status===0?new Error(s.message):new Error("'Hasta' debe ser mayor que 'desde'")}}async getIntLito(t,o){let i=this.getUserIdOrThrow();try{return await m(this.httpClient.get(`${this.baseURL(i,t)}/intervalo_litologico/${o}`))}catch(r){throw console.log("Mensaje de error",r.error?.message??r.message),r.status===0?new Error(r.message):new Error(r.error?.message??"Error al obtener intervalo litologico")}}static \u0275fac=function(o){return new(o||e)};static \u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})};function O(e,t){if(e&1){let o=w();l(0,"app-intervalo-lit-form",6),u("saved",function(r){L(o);let s=p();return E(s.handleEdit(r))}),n()}if(e&2){let o=p();f("intervaloLitologico",o.intervaloResource.value())}}function H(e,t){e&1&&y(0,"ion-spinner")}function G(e,t){e&1&&(l(0,"p"),d(1,"No se encontr\xF3 el intervalo litol\xF3gico"),n())}function J(e,t){if(e&1&&(l(0,"div",5),d(1),n()),e&2){let o=p();c(),x(" ",o.errorMessage()," ")}}var V=class e{interevaloEditLito=a(g);toastController=a(F);router=a(R);errorMessage=v("");disabled=v(!1);id_pozo=I.required();id_intervalo_litologico=I.required();intervaloResource=P({params:()=>({idPozo:this.id_pozo(),idIntervalo:this.id_intervalo_litologico()}),loader:({params:t})=>this.interevaloEditLito.getIntLito(t.idPozo,t.idIntervalo)});async handleEdit(t){try{let o=this.id_pozo(),i=this.id_intervalo_litologico();this.disabled.set(!0);let r=await this.interevaloEditLito.editIntervaloLito(o,i,t);console.log("Intervalo editado",r),this.router.navigate([`/pozos/${o}/intervalos-litologicos-list`])}catch(o){await(await this.toastController.create({message:o.message,duration:1e3,position:"bottom",color:"danger",animated:!0})).present()}this.disabled.set(!1)}irAtras(){this.router.navigate([`pozos/${this.id_pozo()}/intervalos-litologicos-list`])}static \u0275fac=function(o){return new(o||e)};static \u0275cmp=C({type:e,selectors:[["app-intervalos-litologicos-edit"]],inputs:{id_pozo:[1,"id_pozo"],id_intervalo_litologico:[1,"id_intervalo_litologico"]},decls:14,vars:3,consts:[[1,"ion-padding"],["slot","start","color","primary"],["default-href","#","color","primary",3,"click"],[3,"intervaloLitologico"],["fill","outline","expand","block",3,"click","disabled"],[1,"error-message"],[3,"saved","intervaloLitologico"]],template:function(o,i){o&1&&(l(0,"ion-content",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-back-button",2),u("click",function(){return i.irAtras()}),n()()(),l(4,"ion-card")(5,"ion-card-content")(6,"h2"),d(7,"Editar intervalo litol\xF3gico"),n(),_(8,O,1,1,"app-intervalo-lit-form",3)(9,H,1,0,"ion-spinner")(10,G,2,0,"p"),l(11,"ion-button",4),u("click",function(){return i.intervaloResource.reload()}),d(12," RECARGAR "),n(),_(13,J,2,1,"div",5),n()()()),o&2&&(c(8),b(i.intervaloResource.hasValue()?8:i.intervaloResource.isLoading()?9:10),c(3),f("disabled",i.disabled()),c(2),b(i.errorMessage()?13:-1))},dependencies:[N,B,S,A,$,M,D,k,T],encapsulation:2})};export{V as IntervalosLitologicosEditPage};
