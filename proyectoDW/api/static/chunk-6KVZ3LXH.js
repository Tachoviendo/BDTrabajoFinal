import{a as L}from"./chunk-TE2OJY6Y.js";import{a as F}from"./chunk-QPFGTPJK.js";import{a as A}from"./chunk-BLXWA4ID.js";import"./chunk-3W6LJROD.js";import{R as S,U as T,V as B,W as M,X as k,aa as N,g as z,ka as $,m as R,ma as U,oa as j}from"./chunk-TEIXOV6V.js";import{Fa as y,Hb as x,Kb as I,O as h,Ra as f,Sa as g,T as n,Wa as b,Xa as s,Y as D,Ya as a,Z as E,Za as C,ea as _,fb as P,ib as c,jb as u,o as v,sa as d,sb as m,ub as w}from"./chunk-5T4QEHQE.js";import"./chunk-6GMPNWKN.js";import"./chunk-GIEMQNDR.js";import"./chunk-WQS6UKMC.js";import"./chunk-HVWPZZJ7.js";import"./chunk-HSZY262W.js";import"./chunk-VSDHJBUA.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-NWJ5J3BN.js";var p=class o{baseURL(t,e){return A.apiURL+`usuarios/${t}/pozos/${e}`}httpClient=n(z);auth=n(F);getUserIdOrThrow(){let t=this.auth.userId();if(!t)throw new Error("No se encontr\xF3 id_usuario autenticado");return t}async editIntervaloDiam(t,e,i){let r=this.getUserIdOrThrow();try{return await v(this.httpClient.put(`${this.baseURL(r,t)}/intervalo_diametro_perforacion/${e}`,i))}catch(l){throw console.log("Mensaje de error",l.error.message),l.status===0?new Error(l.message):new Error("'Hasta' debe ser mayor que 'desde'")}}async getIntDiamById(t,e){let i=this.getUserIdOrThrow();try{return await v(this.httpClient.get(`${this.baseURL(i,t)}/intervalo_diametro_perforacion/${e}`))}catch(r){throw console.log("Mensaje de error",r.error?.message??r.message),r.status===0?new Error(r.message):new Error(r.error?.message??"Error al obtener intervalo de di\xE1metro")}}static \u0275fac=function(e){return new(e||o)};static \u0275prov=h({token:o,factory:o.\u0275fac,providedIn:"root"})};function O(o,t){if(o&1){let e=P();s(0,"app-intervalo-diam-form",6),c("saved",function(r){D(e);let l=u();return E(l.handleEdit(r))}),a()}if(o&2){let e=u();b("intervaloDiametro",e.intervaloResource.value())}}function H(o,t){o&1&&C(0,"ion-spinner")}function G(o,t){o&1&&(s(0,"p"),m(1,"No se encontr\xF3 el intervalo de di\xE1metro"),a())}function J(o,t){if(o&1&&(s(0,"div",5),m(1),a()),o&2){let e=u();d(),w(" ",e.errorMessage()," ")}}var V=class o{interevaloEditService=n(p);toastController=n(j);router=n(R);errorMessage=_("");disabled=_(!1);id_pozo=I.required();id_intervalo_diametro=I.required();intervaloResource=x({params:()=>({idPozo:this.id_pozo(),idIntervalo:this.id_intervalo_diametro()}),loader:({params:t})=>this.interevaloEditService.getIntDiamById(t.idPozo,t.idIntervalo)});async handleEdit(t){try{let e=this.id_pozo(),i=this.id_intervalo_diametro();this.disabled.set(!0);let r=await this.interevaloEditService.editIntervaloDiam(e,i,t);console.log("Perforacion editada",r),this.router.navigate([`/pozos/${e}/intervalos-diametros-list`])}catch(e){await(await this.toastController.create({message:e.message,duration:1e3,position:"bottom",color:"danger",animated:!0})).present()}this.disabled.set(!1)}irAtras(){this.router.navigate([`pozos/${this.id_pozo()}/intervalos-diametros-list`])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=y({type:o,selectors:[["app-intervalos-diametros-edit"]],inputs:{id_pozo:[1,"id_pozo"],id_intervalo_diametro:[1,"id_intervalo_diametro"]},decls:14,vars:3,consts:[[1,"ion-padding"],["slot","start","color","primary"],["default-href","#","color","primary",3,"click"],[3,"intervaloDiametro"],["fill","outline","expand","block",3,"click","disabled"],[1,"error-message"],[3,"saved","intervaloDiametro"]],template:function(e,i){e&1&&(s(0,"ion-content",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-back-button",2),c("click",function(){return i.irAtras()}),a()()(),s(4,"ion-card")(5,"ion-card-content")(6,"h2"),m(7,"Editar intervalo de di\xE1metros"),a(),f(8,O,1,1,"app-intervalo-diam-form",3)(9,H,1,0,"ion-spinner")(10,G,2,0,"p"),s(11,"ion-button",4),c("click",function(){return i.intervaloResource.reload()}),m(12," RECARGAR "),a(),f(13,J,2,1,"div",5),a()()()),e&2&&(d(8),g(i.intervaloResource.hasValue()?8:i.intervaloResource.isLoading()?9:10),d(3),b("disabled",i.disabled()),d(2),g(i.errorMessage()?13:-1))},dependencies:[N,M,k,L,$,T,U,B,S],encapsulation:2})};export{V as IntervalosDiametrosEditPage};
